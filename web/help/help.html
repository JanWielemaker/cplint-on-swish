<!DOCTYPE HTML>

<html>
  <head>
  <title>cplint on SWISH</title>
<link rel="stylesheet" href="/css/swish.css">
<style>
body {
 overflow: scroll;
  margin: 10px;
 }
</style>
</head>
<body>

<h4>Table of Contents</h4>
  <ul>
    <li><a href="#help-basics">Basic operation</a></li>
    <li><a href="#help-examples">Embedding examples in the program text</a></li>
    <li><a href="#help-share">Save or share your program</a></li>
    <li><a href="#help-include">Include other programs</a></li>
    <li><a href="#help-preload">Preload SWISH with data</a></li>
    <li><a href="#help-LPAD">LPAD and CP-logic syntax</a></li>
    <li><a href="http://ds.ing.unife.it/~friguzzi/software/cplint-swi/manual.html" target="_blank">cplint manual</a></li>
  </ul>
<h2 id="help-basics">Basic operation</h2>
<p>
cplint is about running a <i>query</i> against a <i>program</i>. 
The program is a Logic Program with Annotated Disjunction (LPAD) or a CP-logic program.
The
<i>query</i> goes into the bottom-right editor and the <i>program</i>
into the left editor.  
<p>
A query can be executed by hitting <code>RETURN</code> if the query
is complete and the caret is behind the '.' that terminates the query
or by using the <b>Run!</b> button.  At this moment, the following happens:

<ol>
  <li>The interface creates a <em>runner</em> in the top-right window
      that controls the execution of the query.
  <li>The runner collects the text from the top-left editor (if any)
      and the query and sends this to the server, which creates a <a target="_blank"
      href="http://www.swi-prolog.org/pldoc/man?section=pengines">Pengine</a>
      (<i>Prolog Engine</i>).
  <li>The Pengine compiles the program into a temporary private module.
  <li>The Pengine assesses whether executing the query can compromise
      the server.  If this fails, an error is displated.  See
      the help topic <b>Caveats ...</b> for details.
  <li>If the query is considered safe, it executes the query and
      communicates with the <em>runner</em>
      about the results using JSON messages.  The <em>runner</em>
      interaction is described in the help topic <b>Runner ...</b>
</ol>

<p>
Note that <b>you do not have to save your program to execute it</b>.  If
your are not satisfied with the answer to a query, you can simply
edit the program and use the <b>Run!</b> again.  The new query is
executed in a completely new environment.  In particular, data that
you asserted in a previous query is not available in the next.

<h2 id="help-examples">Embedding examples in the program text</h2>
<p>
If you include example goals inside comments as shown below,
they will be used to populate the example menu and make the
first goal show in the Goal input field.
</p>
<pre style="font-size:80%">
/** &lt;examples&gt;

?- loves(X, mia).
?- jealous(X, Y).

*/</pre>

<h2 id="help-share">Save or share your program</h2>
<p>
The menu <b>File/Save ...</b> can be used to save your program.  There
are several options:

  <ul>
    <li>By default, the program is saved to a randomly generated name
        and may be searched by all users.  The <b>Public | Name</b> fields
	can be used to hide the file and/or give it a name.
    <li>The title is displayed in the search results and can help others
        to guess what the file is about.
    <li>You can fill in the author.  Future versions are likely to use
        login for that.
    <li>If an updated version of the file is changed, <b>Changes</b> may
        be used to summarise the changes.
    <li>Tags may be added to help people finding your code.  Type a comma
        (,) to start a new tag.
  </ul>

<p>
The <b>Info &amp; History ...</b> menu can be used to examine and use
old versions of the program.

<h2 id="help-include">Include other programs</h2>
<p>
If you know the name of a saved program (see above), you can reuse this
program using Prolog's <b>include/1</b> predicate as illustrated below.

<pre style="font-size:80%">
:- include(clever).
</pre>

You can also include a <em>specific version</em> of a program by including
its <em>hash</em>.  You can find the hash of a specific version using
<b>Info &amp; History ...</b>, selecting the desired version and opening
it using the <em>play</em> button.  This will display the hash in the
browser's address field.  Now, include this version using e.g.,

<pre style="font-size:80%">
:- include('23dacada6952ec6701da2dc9d4ebcf5c7b860380').
</pre>

<p>
Using <b>File/Collaborate ...</b>, you create a
<a target="_blank" href="https://togetherjs.com/">TogetherJS</a> session
that provides shared editing, chat and voice communication.


<h4 id="help-examples">Embedding examples in the program text</h4>
<p>
If you include example goals inside comments as shown below,
they will be used to populate the example menu and make the
first goal show in the Goal input field.
</p>
<pre style="font-size:80%">
/** &lt;examples&gt;

?- loves(jay, mia).
?- jealous(jay, mia).

*/</pre>

<h4 id="help-share">Save or share your program</h4>
<p>
If you use <b>File/Save</b>, the server will save your program in a file
with a unique random name and add this name to the URL displayed in the
browser's address bar. You can later come back to this source by going
to this URL. You can also sent the URL to a friend and let him or her
have a look at your program.  Anyone can save the program, but the last
one wins.  In the future, we will add versioning.

<p>
Using <b>File/Collaborate ...</b>, you create a
<a target="_blank" href="https://togetherjs.com/">TogetherJS</a> session
that provides shared editing, chat and voice communication.


<h4 id="help-preload">Preload SWISH with data</h4>
<p>
You can make <span style="color:maroon">cplint on </span>
<span style="color:darkblue">SWI</span><span style="color:maroon">SH</span>
start with a loaded program using the URL <code>http://cplint.lamping.unife.it/</code> and
providing the parameters below.  The URL accepts both `GET` and `POST` requests.

  <dl>
  <dt>code<dd>
  Either the concrete code or a URL from which the code will be downloaded.
  </dd>
  <dt>background<dd>
  As <code>code</code>, but this part of the code will not be visible in
  the editor.
  </dd>
  <dt>examples<dd>
  As the above described examples comment block.
  </dd>
  <dt>q<dd>
  The initial query to load into the query window.  Note that the following
  characters need to be escaped: '#', '&' and the space.
  </dd>
  </dl>

<p>The URL below opens <span style="color:maroon">cplint on </span>
<span style="color:darkblue">SWI</span><span style="color:maroon">SH</span> on a file from GitHub with a default query.

<pre>
http://cplint.lamping.unife.it/?code=https://github.com/friguzzi/swish/raw/master/examples/alarm.cpl&amp;q=alarm(t).</pre>

 <h2 id="help-LPAD">LPAD and CP-logic syntax</h2>
<p>
LPAD and CP-logic programs consist of a set of annotated disjunctive clauses.
Disjunction in the head is represented with a semicolon and atoms in the head are
separated from probabilities by a colon. For the rest, the usual syntax of Prolog is
used. A general CP-logic clause has the form

 <pre style="font-size:80%">
h1:p1 ; ... ; hn:pn :- b1,...,bm,\+ c1,....,\+ cl.
</pre>
<!--l. 78--><p> No parentheses are necessary. The <code>pi</code> are numeric expressions. It is up to the user to
ensure that the numeric expressions are legal, i.e. that they sum up to less or equal to
one.
<!--l. 81--><p>   If the clause has an empty body, it can be represented like this
 <pre style="font-size:80%">
h1:p1 ; ... ; hn:pn.
</pre>
<!--l. 84--><p> If the clause has a single head with probability 1, the annotation can be omitted and
the clause takes the form of a normal Prolog clause, i.e.

 <pre style="font-size:80%">
h1 :- b1,...,bm,\+ c1,...,\+ cl.
</pre>
<!--l. 88--><p> stands for

  <pre style="font-size:80%">
h1:1 :- b1,...,bm,\+ c1,...,\+ cl.
</pre>
<!--l. 94--><p>  Consider the coin example 

 <pre style="font-size:80%">
heads(Coin):1/2 ; tails(Coin):1/2:-  
     toss(Coin),\+biased(Coin).  
heads(Coin):0.6 ; tails(Coin):0.4:-  
     toss(Coin),biased(Coin).  
fair(Coin):0.9 ; biased(Coin):0.1.  
toss(coin).
</pre>
<!--l. 105--><p> The first clause states that if we toss a coin that is not biased it has equal
probability of landing heads and tails. The second states that if the coin is biased it
has a slightly higher probability of landing heads. The third states that the coin is
fair with probability 0.9 and biased with probability 0.1 and the last clause states
that we toss a coin for certain.
<!--l. 108--><p>   Moreover, the bodies of rules can contain the built-in predicates:

 <pre style="font-size:80%">
is/2, &#x003E;/2, &#x003C;/2, &#x003E;=/2, =&#x003C;/2,
=:=/2, =\=/2, true/0, false/0,
=/2, ==/2, \=/2, \==/2, length/2
</pre>
<!--l. 113--><p> The bodies can also contain the following library predicates:

 <pre style="font-size:80%">
member/2, max_list/2, min_list/2  
nth0/3, nth/3, dif/2, select/3
</pre>
<!--l. 119--><p > plus the predicate

 <pre style="font-size:80%">
average/2
</pre>
<!--l. 123--><p > that, given a list of numbers, computes its arithmetic mean.

<span style="color:maroon">cplint on </span>
<span style="color:darkblue">SWI</span><span style="color:maroon">SH</span> allows two types of programs: LPAD and Prolog. In the first, you can simply insert LPAD/CP-logic code and ask queries by writing the atom of which you want to compute the probability. In the coin example, the probability of <code>heads(coin)</code> can be obtained with the query <code>heads(coin)</code>. In Prolog programs, you have to load the <code>pita</code> library, wrap LPAD/CP-logic code with the compiler directives <code>:- cplint</code> and <code>:- end_cplint.</code> and ask the probability of an atom using the predicate <code>prob/2</code>.

The coin example above in Prolog is
 <pre style="font-size:80%">
:- use_module(library(pita)).
:- cplint.
heads(Coin):1/2 ; tails(Coin):1/2:-  
     toss(Coin),\+biased(Coin).  
heads(Coin):0.6 ; tails(Coin):0.4:-  
     toss(Coin),biased(Coin).  
fair(Coin):0.9 ; biased(Coin):0.1.  
toss(coin).
:- end_cplint.
</pre>
To query the probability of <code>heads(coin)</code> you have to ask
 <pre style="font-size:80%">
prob(heads(coin),P).
</pre>


See the <a href="http://ds.ing.unife.it/~friguzzi/software/cplint-swi/manual.html" target="_blank">cplint manual</a> for more information.
</body>
</html>








